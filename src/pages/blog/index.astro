---
import Layout from '../../layouts/Layout.astro';
import { getCollection } from 'astro:content';
import { format } from 'date-fns';

const posts = await getCollection('blog');
posts.sort((a, b) => b.data.date.getTime() - a.data.date.getTime());
---

<Layout title="Blog | Elegant Scroll">
  <h1>Blog Posts</h1>
  
  {posts.length === 0 ? (
    <p class="empty-state">No posts yet. Create your first post in the <code>src/content/blog/</code> directory!</p>
  ) : (
    <ul class="post-list">
      {posts.map((post) => (
        <li>
          <article class="post-preview">
            <a href={`/blog/${post.slug}`}>
              <h2>{post.data.title}</h2>
              <time datetime={post.data.date.toISOString()}>
                {format(post.data.date, 'MMMM d, yyyy')}
              </time>
              <p>{post.data.description}</p>
            </a>
          </article>
        </li>
      ))}
    </ul>
  )}
</Layout>

<style>
  h1 {
    font-size: 2.5rem;
    margin-bottom: 2rem;
  }

  .empty-state {
    text-align: center;
    padding: 3rem;
    background: rgba(139, 69, 19, 0.05);
    border-radius: 8px;
    font-style: italic;
  }

  .post-list {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .post-preview {
    margin-bottom: 2.5rem;
  }

  .post-preview a {
    text-decoration: none;
    color: inherit;
    display: block;
    padding: 1.5rem;
    background: white;
    border-radius: 8px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    transition: transform 0.2s ease;
  }

  .post-preview a:hover {
    transform: translateY(-2px);
  }

  .post-preview h2 {
    margin: 0;
    color: var(--text-color);
  }

  .post-preview time {
    display: block;
    font-size: 0.9rem;
    color: rgba(44, 24, 16, 0.6);
    margin: 0.5rem 0;
  }

  code {
    background: rgba(139, 69, 19, 0.1);
    padding: 0.2em 0.4em;
    border-radius: 4px;
    font-size: 0.9em;
  }
</style>